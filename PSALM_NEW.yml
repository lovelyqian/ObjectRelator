channels:
  - pytorch
  - nvidia
  - conda-forge
dependencies:
  - python=3.10.*
  - pytorch==2.0.1
  - torchvision==0.15.2
  - torchaudio==2.0.2
  - pytorch-cuda=11.8
  - mkl=2024.0.0
  - pip
  - pip:
    - git+https://github.com/facebookresearch/detectron2.git
    - git+https://github.com/cocodataset/panopticapi.git
    - git+https://github.com/mcordts/cityscapesScripts.git
postinstall: |
    export CUDA_HOME=/opt/modules/nvidia-cuda-11.8.0
    export PATH=/opt/modules/nvidia-cuda-11.8.0/bin:$PATH
    export LD_LIBRARY_PATH=/opt/modules/nvidia-cuda-11.8.0/lib64:$LD_LIBRARY_PATH
    export CC=/usr/bin/gcc-11
    export CXX=/usr/bin/g++-11
    echo $CUDA_HOME
    nvcc --version
    which nvcc 
    which -a gcc
    cd /home/yuqian_fu/Projects/PSALM
    pip install -e .
    pip install opencv-python addict
    gcc --version
    cd psalm/model/mask_decoder/Mask2Former_Simplify/modeling/pixel_decoder/ops
    sh make.sh
    pip install numpy==1.23.5
