# name: ego_new
channels:
  - pytorch
  - nvidia
  - conda-forge
dependencies:
  - python=3.10.*
  - pytorch==2.0.1
  - torchvision==0.15.2
  - torchaudio==2.0.2
  - gcc_linux-64=9
  - gxx_linux-64=9
  - pytorch-cuda=11.8
  - mkl=2024.0.0
  - pip
  - pip:
    - git+https://github.com/facebookresearch/detectron2.git
    - git+https://github.com/cocodataset/panopticapi.git
    - git+https://github.com/mcordts/cityscapesScripts.git
postinstall: |
    export CUDA_HOME=/opt/modules/nvidia-cuda-11.8.0
    export PATH=/opt/modules/nvidia-cuda-11.8.0/bin:$PATH
    export LD_LIBRARY_PATH=/opt/modules/nvidia-cuda-11.8.0/lib64:$LD_LIBRARY_PATH
    export TORCH_CUDA_ARCH_LIST="7.5;8.0;8.6;9.0"
    echo $CUDA_HOME
    cd /home/yuqian_fu/Projects/ObjectRelator
    pip install -e .
    pip install opencv-python addict
    echo "gcc version:"
    gcc --version
    cd objectrelator/model/mask_decoder/Mask2Former_Simplify/modeling/pixel_decoder/ops
    python setup.py clean
    rm -rf build/
    sh make.sh
    pip install natsort
    pip install scikit-image
    pip install numpy==1.23.5




# variables:
#   CC: /usr/bin/gcc-9
#   CXX: /usr/bin/g++-9
#   TORCH_NVCC_FLAGS: "--compiler-bindir=/usr/bin/gcc-9"

# export CC=/usr/bin/gcc-9
# export CXX=/usr/bin/g++-9
# export TORCH_NVCC_FLAGS="--compiler-bindir=/usr/bin/gcc-9"

# export TORCH_CUDA_ARCH_LIST="your_arch_list_here"   # （可选）